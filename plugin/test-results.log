
> obsidian-semantic-search@0.1.0 test
> jest

ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
FAIL src/__tests__/search-view-new.test.ts
  ‚óè Test suite failed to run

    Cannot find module 'obsidian' from 'src/__tests__/search-view-new.test.ts'

       9 |
      10 | // Mock Obsidian API
    > 11 | jest.mock('obsidian', () => ({
         |      ^
      12 |     ItemView: class {
      13 |         containerEl = {
      14 |             children: [null, document.createElement('div')],

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/__tests__/search-view-new.test.ts:11:6)

PASS src/__tests__/chunker.test.ts
FAIL src/__tests__/embedding-service.test.ts
  ‚óè EmbeddingService ‚Ä∫ Local Provider (Transformers.js) ‚Ä∫ should generate consistent embeddings

    expect(received).toBeGreaterThan(expected)

    Expected: > 0.99
    Received:   0.7462435957524967

      47 |             // Embeddings should be very similar (not exact due to floating point)
      48 |             const similarity = cosineSimilarity(embedding1, embedding2);
    > 49 |             expect(similarity).toBeGreaterThan(0.99);
         |                                ^
      50 |         }, 30000);
      51 |
      52 |         it('should handle empty text', async () => {

      at src/__tests__/embedding-service.test.ts:49:32
      at fulfilled (node_modules/tslib/tslib.js:167:62)

PASS src/__tests__/api-client.test.ts
PASS src/__tests__/integration.test.ts
  ‚óè Console

    console.log
      ‚úì Chunked into 5 pieces

      at src/__tests__/integration.test.ts:63:17

    console.log
      ‚úì Generated 5 embeddings

      at src/__tests__/integration.test.ts:81:17

    console.log
      ‚úì Stored 5 vectors in Qdrant

      at src/__tests__/integration.test.ts:86:17

    console.log
      ‚úì Search returned 3 results

      at src/__tests__/integration.test.ts:96:17

    console.log
      Top result (score: 0.7659): # Machine Learning Basics
      
      Machine learning is a subset of artificial intelligence.

      at src/__tests__/integration.test.ts:101:17

    console.log
      ‚úì Indexed 2 documents

      at src/__tests__/integration.test.ts:162:17

    console.log
      ‚úì Found 4 relevant chunks

      at src/__tests__/integration.test.ts:170:17

    console.log
      Documents in results: [ 'doc2', 'doc1' ]

      at src/__tests__/integration.test.ts:174:17

PASS src/__tests__/vector-store.test.ts
PASS src/__tests__/process-manager.test.ts (34.994 s)
  ‚óè Console

    console.error
      Failed to start Rust service (attempt 1/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 2/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 3/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 1/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 2/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 3/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 1/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 2/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 3/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 1/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 2/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)

    console.error
      Failed to start Rust service (attempt 3/3): Error: Service did not become available within timeout
          at ProcessManager.<anonymous> (/home/bowie/code/ob-image-vector/plugin/src/process-manager.ts:118:15)
          at Generator.next (<anonymous>)
          at fulfilled (/home/bowie/code/ob-image-vector/plugin/node_modules/tslib/tslib.js:167:62)

      61 |             } catch (error) {
      62 |                 this.retryCount = attempt + 1;
    > 63 |                 console.error(`Failed to start Rust service (attempt ${this.retryCount}/${this.config.maxRetries}):`, error);
         |                         ^
      64 |
      65 |                 if (attempt < this.config.maxRetries - 1) {
      66 |                     await this.delay(this.config.retryDelayMs);

      at ProcessManager.<anonymous> (src/process-manager.ts:63:25)
          at Generator.throw (<anonymous>)
      at rejected (node_modules/tslib/tslib.js:168:69)


Test Suites: 2 failed, 5 passed, 7 total
Tests:       1 failed, 69 passed, 70 total
Snapshots:   0 total
Time:        35.521 s
Ran all test suites.
